option_settings:
  aws:elasticbeanstalk:application:environment:
    APP_ENV: production
    APP_DEBUG: false
    APP_KEY: base64:YOUR_APP_KEY
    COMPOSER_HOME: /root

packages:
  yum:
    git: []
    unzip: []
    php-cli: []
    php-mbstring: []
    php-xml: []
    php-pdo: []
    php-mysqlnd: []
    php-bcmath: []
    php-json: []
    php-tokenizer: []

container_commands:
  01_storage_permissions:
    command: |
      chmod -R 775 storage
      chmod -R 775 bootstrap/cache
      chown -R webapp:webapp storage
      chown -R webapp:webapp bootstrap/cache
    ignoreErrors: false

  02_create_storage_dirs:
    command: |
      mkdir -p storage/framework/sessions
      mkdir -p storage/framework/views
      mkdir -p storage/framework/cache
      mkdir -p storage/logs
      mkdir -p bootstrap/cache
      chmod -R 775 storage
      chmod -R 775 bootstrap/cache
      chown -R webapp:webapp storage
      chown -R webapp:webapp bootstrap/cache
    ignoreErrors: false

  03_clear_config_cache:
    command: |
      cd /var/app/current
      php artisan config:clear
      php artisan cache:clear
      php artisan route:clear
    ignoreErrors: false
